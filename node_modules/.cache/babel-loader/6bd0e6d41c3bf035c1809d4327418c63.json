{"ast":null,"code":"import _classCallCheck from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./Player.css';import{API_BASE_URL}from'../../constants/apiConstants';//https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode/getFloatFrequencyData\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Player=/*#__PURE__*/function(_React$Component){_inherits(Player,_React$Component);var _super=_createSuper(Player);function Player(props){var _this;_classCallCheck(this,Player);_this=_super.call(this,props);_this.onAudioLoad=function(){try{var audioCtx=new AudioContext();var audio=document.getElementById('track');var audioSourceNode=audioCtx.createMediaElementSource(audio);_this.analyserNode=audioCtx.createAnalyser();_this.analyserNode.fftSize=1024;_this.bufferLength=_this.analyserNode.frequencyBinCount;_this.dataArray=new Float32Array(_this.bufferLength);audioSourceNode.connect(_this.analyserNode);_this.analyserNode.connect(audioCtx.destination);}catch(error){}};_this.onTimeUpdateHandler=function(){try{//Schedule next redraw\nrequestAnimationFrame(_this.onTimeUpdateHandler);//Get spectrum data\n_this.analyserNode.getFloatFrequencyData(_this.dataArray);//Draw black background\n_this.canvasCtx.fillStyle='rgb(255, 255, 255)';_this.canvasCtx.fillRect(0,0,_this.canvas.width,_this.canvas.height);//Draw spectrum\nvar barWidth=_this.canvas.width/_this.bufferLength*2.5;var posX=0;for(var i=0;i<_this.bufferLength;i++){var barHeight=(_this.dataArray[i]+140)*2;_this.canvasCtx.fillStyle='rgb(52 , 58, 74)';_this.canvasCtx.fillRect(posX,_this.canvas.height-barHeight/2,barWidth,barHeight/2);posX+=barWidth+1;}}catch(error){}};_this.state={open:false};_this.analyserNode=null;_this.dataArray=null;_this.bufferLength=null;_this.onTimeUpdateHandler=_this.onTimeUpdateHandler.bind(_assertThisInitialized(_this));_this.onAudioLoad=_this.onAudioLoad.bind(_assertThisInitialized(_this));return _this;}_createClass(Player,[{key:\"componentDidMount\",value:function componentDidMount(){this.canvas=document.getElementById('visualizer');this.canvasCtx=this.canvas.getContext('2d');this.onAudioLoad();this.onTimeUpdateHandler();}},{key:\"render\",value:function render(){if(this.props.currentSongID){return/*#__PURE__*/_jsxs(\"div\",{className:\"player\",children:[/*#__PURE__*/_jsx(\"figcaption\",{id:\"caption\",children:this.props.currentSongName}),/*#__PURE__*/_jsxs(\"audio\",{id:\"track\",controls:true,crossorigin:\"anonymous\",src:API_BASE_URL+'/media/getSongFile?songID='+this.props.currentSongID,children:[\"Your browser does not support the\",/*#__PURE__*/_jsx(\"code\",{children:\"audio\"}),\" element.\"]})]});}else{return/*#__PURE__*/_jsxs(\"div\",{className:\"player\",children:[/*#__PURE__*/_jsx(\"figcaption\",{id:\"caption\",children:\"Test Song\"}),/*#__PURE__*/_jsxs(\"audio\",{id:\"track\",controls:true,crossorigin:\"anonymous\",src:\"https://file-examples-com.github.io/uploads/2017/11/file_example_MP3_700KB.mp3\",children:[\"Your browser does not support the\",/*#__PURE__*/_jsx(\"code\",{children:\"audio\"}),\" element.\"]})]});}}}]);return Player;}(React.Component);export default Player;","map":{"version":3,"sources":["/home/jan/SoundTrackBoxFrontend/src/components/MainComponents/Player.js"],"names":["React","API_BASE_URL","Player","props","onAudioLoad","audioCtx","AudioContext","audio","document","getElementById","audioSourceNode","createMediaElementSource","analyserNode","createAnalyser","fftSize","bufferLength","frequencyBinCount","dataArray","Float32Array","connect","destination","error","onTimeUpdateHandler","requestAnimationFrame","getFloatFrequencyData","canvasCtx","fillStyle","fillRect","canvas","width","height","barWidth","posX","i","barHeight","state","open","bind","getContext","currentSongID","currentSongName","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Player.css';\nimport {API_BASE_URL} from '../../constants/apiConstants'\n\n//https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode/getFloatFrequencyData\nclass Player extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            open: false,\n        }\n        this.analyserNode = null;\n        this.dataArray = null;\n        this.bufferLength = null;\n        this.onTimeUpdateHandler = this.onTimeUpdateHandler.bind(this);\n        this.onAudioLoad = this.onAudioLoad.bind(this);\n    }\n\n    componentDidMount(){\n        this.canvas = document.getElementById('visualizer');\n        this.canvasCtx = this.canvas.getContext('2d');\n        this.onAudioLoad();\n        this.onTimeUpdateHandler();\n    }\n\n    onAudioLoad = () => {\n        try {\n            const audioCtx = new AudioContext();\n            var audio = document.getElementById('track');\n            const audioSourceNode = audioCtx.createMediaElementSource(audio);\n    \n            this.analyserNode = audioCtx.createAnalyser();\n            this.analyserNode.fftSize = 1024;\n            this.bufferLength = this.analyserNode.frequencyBinCount;\n            this.dataArray = new Float32Array(this.bufferLength);\n    \n            audioSourceNode.connect(this.analyserNode);\n            this.analyserNode.connect(audioCtx.destination);\n        } catch (error) {\n        }\n    }\n\n    onTimeUpdateHandler = () => {\n        try {\n                    //Schedule next redraw\n        requestAnimationFrame(this.onTimeUpdateHandler);\n\n        //Get spectrum data\n        this.analyserNode.getFloatFrequencyData(this.dataArray);\n\n        //Draw black background\n        this.canvasCtx.fillStyle = 'rgb(255, 255, 255)';\n        this.canvasCtx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n        //Draw spectrum\n        const barWidth = (this.canvas.width / this.bufferLength) * 2.5;\n        let posX = 0;\n        for (let i = 0; i < this.bufferLength; i++) {\n            const barHeight = (this.dataArray[i] + 140) * 2;\n            this.canvasCtx.fillStyle = 'rgb(52 , 58, 74)';\n            this.canvasCtx.fillRect(posX, this.canvas.height - barHeight / 2, barWidth, barHeight / 2);\n            posX += barWidth + 1;\n        }\n        } catch (error) {\n        }\n    }\n\n    render() {\n        if(this.props.currentSongID){\n        return (\n            <div className=\"player\">\n                <figcaption id=\"caption\">{this.props.currentSongName}</figcaption>\n                <audio\n                    id=\"track\"\n                    controls\n                    crossorigin=\"anonymous\"\n                    src={API_BASE_URL + '/media/getSongFile?songID=' + this.props.currentSongID}\n                >\n                    Your browser does not support the\n              <code>audio</code> element.\n          </audio>\n            </div>\n        )} else {\n            return (\n                <div className=\"player\">\n                <figcaption id=\"caption\">Test Song</figcaption>\n                <audio\n                    id=\"track\"\n                    controls\n                    crossorigin=\"anonymous\"\n                    src=\"https://file-examples-com.github.io/uploads/2017/11/file_example_MP3_700KB.mp3\"\n                >\n                    Your browser does not support the\n              <code>audio</code> element.\n          </audio>\n            </div>\n            )\n        }\n    }\n}\n\nexport default Player;"]},"metadata":{},"sourceType":"module"}