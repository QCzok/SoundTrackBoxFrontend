{"ast":null,"code":"import _regeneratorRuntime from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/jan/SoundTrackBoxFrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./Playlist.css';import Accordion from'react-bootstrap/Accordion';import Card from'react-bootstrap/Card';import Button from'react-bootstrap/Button';import Cookies from'universal-cookie';import UploadDialog from'../Dialogs/UploadDialog';import Song from'./Song';import axios from'axios';import{API_BASE_URL,ACCESS_TOKEN_NAME}from'../../constants/apiConstants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Playlist=/*#__PURE__*/function(_React$Component){_inherits(Playlist,_React$Component);var _super=_createSuper(Playlist);function Playlist(props){var _this;_classCallCheck(this,Playlist);_this=_super.call(this,props);_this.onSelect=function(songID){console.log('the song url is: '+songID);};_this.state={fetchInProgress:false};_this.handleUpload=_this.handleUpload.bind(_assertThisInitialized(_this));_this.deletePlaylist=_this.deletePlaylist.bind(_assertThisInitialized(_this));return _this;}_createClass(Playlist,[{key:\"addSongPost\",value:function(){var _addSongPost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(playlistName,playlistID,songName,selectedFile){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:data=new FormData();data.append('playlistName',playlistName);data.append('playlistID',playlistID);data.append('songName',songName);data.append('track',selectedFile);return _context.abrupt(\"return\",axios.post(API_BASE_URL+'/media/addSong',data,{headers:{\"auth-token\":localStorage.getItem(ACCESS_TOKEN_NAME)}}).then(function(response){if(response.status===200){return response.data.affected;}}).catch(function(error){console.log(error);}));case 6:case\"end\":return _context.stop();}}},_callee);}));function addSongPost(_x,_x2,_x3,_x4){return _addSongPost.apply(this,arguments);}return addSongPost;}()},{key:\"deletePlaylistPost\",value:function(){var _deletePlaylistPost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(playlistID){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",axios.post(API_BASE_URL+'/media/deletePlaylist',{playlistID:playlistID},{headers:{\"auth-token\":localStorage.getItem(ACCESS_TOKEN_NAME)}}).then(function(response){if(response.status===200){return response.data.affected;}}).catch(function(error){console.log(error);}));case 1:case\"end\":return _context2.stop();}}},_callee2);}));function deletePlaylistPost(_x5){return _deletePlaylistPost.apply(this,arguments);}return deletePlaylistPost;}()},{key:\"handleUpload\",value:function handleUpload(songName,selectedFile){var _this2=this;this.setState({fetchInProgress:true});Promise.resolve(this.addSongPost(this.props.playlistName,this.props.playlistID,songName,selectedFile)).then(function(result){return _this2.props.parentCallback(result);}).then(function(){_this2.setState({fetchInProgress:false});});}},{key:\"deletePlaylist\",value:function deletePlaylist(){var _this3=this;var cookies=new Cookies();Promise.resolve(this.deletePlaylistPost(this.props.playlistID)).then(function(result){_this3.props.songCollection.map(function(song){if(song._id===cookies.get('songID')){_this3.props.updateCurrentSong(undefined,undefined);}});_this3.props.parentCallback(result);});}},{key:\"render\",value:function render(){var _this4=this;this.songs=this.props.songCollection.map(function(song){return/*#__PURE__*/_jsx(Accordion.Collapse,{eventKey:\"0\",children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Song,{playlistID:_this4.props.playlistID,songName:song.songName,songID:song._id,parentCallback:_this4.props.parentCallback,updateCurrentSong:_this4.props.updateCurrentSong})},song._id)},song._id);});if(this.state.fetchInProgress){return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:\"Loading...\"})})});}else{return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Accordion,{children:[/*#__PURE__*/_jsxs(\"div\",{id:\"playlistBox\",className:\"card-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"nav-item dropdown\",children:[/*#__PURE__*/_jsx(\"a\",{className:\"nav-link dropdown-toggle\",href:\"#\",id:\"navbarDropdownMenuLink\",\"data-toggle\":\"dropdown\",\"aria-haspopup\":\"true\",\"aria-expanded\":\"false\",children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",fill:\"currentColor\",class:\"bi bi-file-music-fill\",viewBox:\"0 0 16 16\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm-.5 4.11v1.8l-2.5.5v5.09c0 .495-.301.883-.662 1.123C7.974 12.866 7.499 13 7 13c-.5 0-.974-.134-1.338-.377-.36-.24-.662-.628-.662-1.123s.301-.883.662-1.123C6.026 10.134 6.501 10 7 10c.356 0 .7.068 1 .196V4.41a1 1 0 0 1 .804-.98l1.5-.3a1 1 0 0 1 1.196.98z\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-menu\",\"aria-labelledby\":\"navbarDropdownMenuLink\",children:[/*#__PURE__*/_jsx(UploadDialog,{id:\"add-song\",parentCallback:this.handleUpload}),/*#__PURE__*/_jsx(\"a\",{className:\"dropdown-item\",onClick:this.deletePlaylist,children:\"Delete this playlist\"})]})]}),/*#__PURE__*/_jsx(Accordion.Toggle,{id:\"playlistItem\",as:Button,variant:\"link\",eventKey:\"0\",children:this.props.playlistName})]}),this.songs]})});}}}]);return Playlist;}(React.Component);export default Playlist;","map":{"version":3,"sources":["/home/jan/SoundTrackBoxFrontend/src/components/MusicCollection/Playlist.js"],"names":["React","Accordion","Card","Button","Cookies","UploadDialog","Song","axios","API_BASE_URL","ACCESS_TOKEN_NAME","Playlist","props","onSelect","songID","console","log","state","fetchInProgress","handleUpload","bind","deletePlaylist","playlistName","playlistID","songName","selectedFile","data","FormData","append","post","headers","localStorage","getItem","then","response","status","affected","catch","error","setState","Promise","resolve","addSongPost","result","parentCallback","cookies","deletePlaylistPost","songCollection","map","song","_id","get","updateCurrentSong","undefined","songs","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Playlist.css'\nimport Accordion from 'react-bootstrap/Accordion';\nimport Card from 'react-bootstrap/Card';\nimport Button from 'react-bootstrap/Button';\nimport Cookies from 'universal-cookie';\n\nimport UploadDialog from '../Dialogs/UploadDialog';\nimport Song from './Song';\n\nimport axios from 'axios';\nimport { API_BASE_URL, ACCESS_TOKEN_NAME } from '../../constants/apiConstants';\n\n\nclass Playlist extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            fetchInProgress: false,\n        }\n        this.handleUpload = this.handleUpload.bind(this);\n        this.deletePlaylist = this.deletePlaylist.bind(this);\n    }\n\n    async addSongPost(playlistName, playlistID, songName, selectedFile) {\n\n        const data = new FormData()\n        data.append('playlistName', playlistName);\n        data.append('playlistID', playlistID);\n        data.append('songName', songName);\n        data.append('track', selectedFile);\n\n\n        return axios.post(API_BASE_URL + '/media/addSong', data, { headers: { \"auth-token\": localStorage.getItem(ACCESS_TOKEN_NAME) } })\n            .then(function (response) {\n                if (response.status === 200) {\n                    return response.data.affected;\n                }\n            }\n            )\n            .catch(function (error) {\n                console.log(error);\n            })\n    }\n\n    async deletePlaylistPost(playlistID) {\n        return axios.post(API_BASE_URL + '/media/deletePlaylist', { playlistID: playlistID}, { headers: { \"auth-token\": localStorage.getItem(ACCESS_TOKEN_NAME) } })\n            .then(function (response) {\n                if (response.status === 200) {\n                    return response.data.affected;\n                }\n            }\n            )\n            .catch(function (error) {\n                console.log(error);\n            })\n    }\n\n    handleUpload(songName, selectedFile) {\n        this.setState({\n            fetchInProgress: true\n        });\n        Promise.resolve(this.addSongPost(this.props.playlistName, this.props.playlistID, songName, selectedFile)).then((result) => this.props.parentCallback(result)).then(() => {\n            this.setState({\n                fetchInProgress: false\n            })\n        });\n    }\n\n\n    onSelect = (songID) => {\n        console.log('the song url is: ' + songID);\n    }\n\n    deletePlaylist() {\n        const cookies = new Cookies();\n        Promise.resolve(this.deletePlaylistPost(this.props.playlistID)).then((result) => {\n            this.props.songCollection.map((song) => {\n                if (song._id === cookies.get('songID')) {\n                    this.props.updateCurrentSong(undefined, undefined);\n                }\n            })\n            this.props.parentCallback(result)\n        }\n        );\n    }\n\n    render() {\n        this.songs = this.props.songCollection.map((song) => {\n            return (\n                <Accordion.Collapse eventKey=\"0\" key={song._id}>\n                    <Card key={song._id}>\n                        <Song\n                            playlistID={this.props.playlistID}\n                            songName={song.songName}\n                            songID={song._id}\n                            parentCallback={this.props.parentCallback}\n                            updateCurrentSong={\n                                this.props.updateCurrentSong\n                            }\n                        >\n                        </Song>\n                    </Card>\n                </Accordion.Collapse>\n            )\n        });\n\n        if (this.state.fetchInProgress) {\n            return (<div className=\"d-flex justify-content-center\">\n                <div className=\"spinner-border\" role=\"status\">\n                    <span className=\"sr-only\">Loading...</span>\n                </div>\n            </div>)\n        } else {\n            return (\n                <>\n                    <Accordion>\n                        <div id=\"playlistBox\" className=\"card-header\">\n                            <div className=\"nav-item dropdown\">\n                                <a className=\"nav-link dropdown-toggle\"\n                                    href=\"#\"\n                                    id=\"navbarDropdownMenuLink\"\n                                    data-toggle=\"dropdown\"\n                                    aria-haspopup=\"true\"\n                                    aria-expanded=\"false\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-file-music-fill\" viewBox=\"0 0 16 16\">\n                                        <path d=\"M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm-.5 4.11v1.8l-2.5.5v5.09c0 .495-.301.883-.662 1.123C7.974 12.866 7.499 13 7 13c-.5 0-.974-.134-1.338-.377-.36-.24-.662-.628-.662-1.123s.301-.883.662-1.123C6.026 10.134 6.501 10 7 10c.356 0 .7.068 1 .196V4.41a1 1 0 0 1 .804-.98l1.5-.3a1 1 0 0 1 1.196.98z\" />\n                                    </svg>\n                                </a>\n                                <div className=\"dropdown-menu\" aria-labelledby=\"navbarDropdownMenuLink\">\n                                    <UploadDialog id=\"add-song\" parentCallback={this.handleUpload} />\n                                    <a className=\"dropdown-item\" onClick={this.deletePlaylist}>Delete this playlist</a>\n                                </div>\n                            </div>\n                            <Accordion.Toggle id=\"playlistItem\" as={Button} variant=\"link\" eventKey=\"0\">\n                                {this.props.playlistName}\n                            </Accordion.Toggle>\n                        </div>\n                        {this.songs}\n                    </Accordion>\n                </>\n            )\n        }\n    }\n}\n\nexport default Playlist;"]},"metadata":{},"sourceType":"module"}