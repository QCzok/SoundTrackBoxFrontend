{"ast":null,"code":"var _jsxFileName = \"/home/jan/SoundTrackBoxFrontend/src/components/Player.js\";\nimport React from 'react';\nimport '../App.css';\nimport { API_BASE_URL } from '../constants/apiConstants'; //https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode/getFloatFrequencyData\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Player extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onAudioLoad = () => {\n      try {\n        const audioCtx = new AudioContext();\n        var audio = document.getElementById('track');\n        const audioSourceNode = audioCtx.createMediaElementSource(audio);\n        this.analyserNode = audioCtx.createAnalyser();\n        this.analyserNode.fftSize = 1024;\n        this.bufferLength = this.analyserNode.frequencyBinCount;\n        this.dataArray = new Float32Array(this.bufferLength);\n        audioSourceNode.connect(this.analyserNode);\n        this.analyserNode.connect(audioCtx.destination);\n      } catch (error) {}\n    };\n\n    this.onTimeUpdateHandler = () => {\n      try {\n        //Schedule next redraw\n        requestAnimationFrame(this.onTimeUpdateHandler); //Get spectrum data\n\n        this.analyserNode.getFloatFrequencyData(this.dataArray); //Draw black background\n\n        this.canvasCtx.fillStyle = 'Gainsboro';\n        this.canvasCtx.fillRect(0, 0, this.canvas.width, this.canvas.height); //Draw spectrum\n\n        const barWidth = this.canvas.width / this.bufferLength * 2.5;\n        let posX = 0;\n\n        for (let i = 0; i < this.bufferLength; i++) {\n          const barHeight = (this.dataArray[i] + 140) * 2;\n          this.canvasCtx.fillStyle = 'chocolate';\n          this.canvasCtx.fillRect(posX, this.canvas.height - barHeight / 2, barWidth, barHeight / 2);\n          posX += barWidth + 1;\n        }\n      } catch (error) {}\n    };\n\n    this.state = {\n      open: false\n    };\n    this.analyserNode = null;\n    this.dataArray = null;\n    this.bufferLength = null;\n    this.onTimeUpdateHandler = this.onTimeUpdateHandler.bind(this);\n    this.onAudioLoad = this.onAudioLoad.bind(this);\n  }\n\n  componentDidMount() {\n    this.canvas = document.getElementById('visualizer');\n    this.canvasCtx = this.canvas.getContext('2d');\n    this.onAudioLoad();\n    this.onTimeUpdateHandler();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"card flex-fill\",\n      children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n        id: \"visualizer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n        class: \"card-title\",\n        children: this.props.currentSongName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n        id: \"track\",\n        controls: true,\n        crossorigin: \"anonymous\",\n        src: API_BASE_URL + '/media/getSongFile?songID=' + this.props.currentSongID,\n        children: [\"Your browser does not support the\", /*#__PURE__*/_jsxDEV(\"code\", {\n          children: \"audio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 29\n        }, this), \" element.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Player;","map":{"version":3,"sources":["/home/jan/SoundTrackBoxFrontend/src/components/Player.js"],"names":["React","API_BASE_URL","Player","Component","constructor","props","onAudioLoad","audioCtx","AudioContext","audio","document","getElementById","audioSourceNode","createMediaElementSource","analyserNode","createAnalyser","fftSize","bufferLength","frequencyBinCount","dataArray","Float32Array","connect","destination","error","onTimeUpdateHandler","requestAnimationFrame","getFloatFrequencyData","canvasCtx","fillStyle","fillRect","canvas","width","height","barWidth","posX","i","barHeight","state","open","bind","componentDidMount","getContext","render","currentSongName","currentSongID"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../App.css';\nimport { API_BASE_URL } from '../constants/apiConstants'\n\n//https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode/getFloatFrequencyData\nclass Player extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            open: false,\n        }\n        this.analyserNode = null;\n        this.dataArray = null;\n        this.bufferLength = null;\n        this.onTimeUpdateHandler = this.onTimeUpdateHandler.bind(this);\n        this.onAudioLoad = this.onAudioLoad.bind(this);\n    }\n\n    componentDidMount() {\n        this.canvas = document.getElementById('visualizer');\n        this.canvasCtx = this.canvas.getContext('2d');\n        this.onAudioLoad();\n        this.onTimeUpdateHandler();\n    }\n\n    onAudioLoad = () => {\n        try {\n            const audioCtx = new AudioContext();\n            var audio = document.getElementById('track');\n            const audioSourceNode = audioCtx.createMediaElementSource(audio);\n\n            this.analyserNode = audioCtx.createAnalyser();\n            this.analyserNode.fftSize = 1024;\n            this.bufferLength = this.analyserNode.frequencyBinCount;\n            this.dataArray = new Float32Array(this.bufferLength);\n\n            audioSourceNode.connect(this.analyserNode);\n            this.analyserNode.connect(audioCtx.destination);\n        } catch (error) {\n        }\n    }\n\n    onTimeUpdateHandler = () => {\n        try {\n            //Schedule next redraw\n            requestAnimationFrame(this.onTimeUpdateHandler);\n\n            //Get spectrum data\n            this.analyserNode.getFloatFrequencyData(this.dataArray);\n\n            //Draw black background\n            this.canvasCtx.fillStyle = 'Gainsboro';\n            this.canvasCtx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n            //Draw spectrum\n            const barWidth = (this.canvas.width / this.bufferLength) * 2.5;\n            let posX = 0;\n            for (let i = 0; i < this.bufferLength; i++) {\n                const barHeight = (this.dataArray[i] + 140) * 2;\n                this.canvasCtx.fillStyle = 'chocolate';\n                this.canvasCtx.fillRect(posX, this.canvas.height - barHeight / 2, barWidth, barHeight / 2);\n                posX += barWidth + 1;\n            }\n        } catch (error) {\n        }\n    }\n\n    render() {\n        return (\n            <div class=\"card flex-fill\">\n                <canvas id=\"visualizer\" />\n                    <h5 class=\"card-title\">{this.props.currentSongName}</h5>\n                    <audio\n                        id=\"track\"\n                        controls\n                        crossorigin=\"anonymous\"\n                        src={API_BASE_URL + '/media/getSongFile?songID=' + this.props.currentSongID}>\n                        Your browser does not support the\n                            <code>audio</code> element.\n                         </audio>\n            </div>\n        )\n    }\n}\n\nexport default Player;"]},"metadata":{},"sourceType":"module"}